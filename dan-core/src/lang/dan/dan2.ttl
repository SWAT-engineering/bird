test D1 [[
    struct Person{
    	int offset = 5
		u8[] bootCode[0x1fd - offset]
	}
]]

test D2 [[
    struct Person{
    	Address address
		u8[] bootCode[0x1fd - address.number]
	}
	
	struct Address{
		int number = 5
	}
]]

test D3 [[
    struct Person{
    	u8[] bootCode[0x1fd - bootCode.offset]
	}
]]

test D4 [[
    struct Person{
    	int foo = 5
    	u8[] bootCode[0x1fd - foo.offset]
	}
]] expect { "Only token types have offsets" }

test D5 [[
    struct Person{
    	struct{
    		int number = 5
    	} address
	}
]]

test D6 [[
    struct Person{
    	struct{
    		int number = 5
    	} address
    	int exposed = address.number
	}
]]

test D7 [[
    struct Person{
    	u8[] grades
    	int firstGrade = grades[0]
	}
]]


test D8 [[
    struct Person{
    	u8[] grades
    	int[] firstGrades = grades[0:2]
	}
]]

test D9 [[
    struct Person{
    	u8[] grades
    	int[] lastGrades = grades[:2]
	}
]]


test D10 [[
    struct Person{
    	u8[] grades
    	int[] gradesFrom = grades[0:]
	}
]]

test D11 [[
choice FileCluster2(u16 myCluster, u32 clusterSize, int clusterStart){
  struct{
  	u16 nextCluster ? (!= 0xFFF8)
  }
  struct{
    u16 nextCluster ? (== 0xFFF8)
  }
}
]]

test D12 [[
choice FileCluster2(u16 myCluster, u32 clusterSize, int clusterStart){
  abstract u16 nextCluster
  struct{
  	u16 nextCluster ? (!= 0xFFF8)
  }
  struct{
    u16 nextCluster ? (== 0xFFF8)
  }
}
]]

test D13 [[
choice FileCluster2(u16 myCluster, u32 clusterSize, int clusterStart){
  abstract u16 nextCluster
  struct{
  	u16 otherCluster ? (!= 0xFFF8)
  }
  struct{
    u16 nextCluster ? (== 0xFFF8)
  }
}
]] expect { "Missing implementation of abstract field" }

test D14 [[
struct AuxStruct{
	u16 nextCluster ? (== 0xFFF8)
}

choice FileCluster2(u16 myCluster, u32 clusterSize, int clusterStart){
  abstract u16 nextCluster
  struct{
  	u16 nextCluster ? (!= 0xFFF8)
  }
  AuxStruct
}
]]

test D14 [[
struct AuxStruct{
}

choice FileCluster2(u16 myCluster, u32 clusterSize, int clusterStart){
  abstract u16 nextCluster
  struct{
  	u16 nextCluster ? (!= 0xFFF8)
  }
  AuxStruct
}
]] expect { "Missing implementation of abstract field" }

test D15 [[
struct AuxStruct{
	u16 nextCluster ? (== 0xFFF8)
	FileCluster2 other
	u16 otherCluster = other.nextCluster
}

choice FileCluster2(u16 myCluster, u32 clusterSize, int clusterStart){
  abstract u16 nextCluster
  struct{
  	u16 nextCluster ? (!= 0xFFF8)
  }
  AuxStruct
}
]]
